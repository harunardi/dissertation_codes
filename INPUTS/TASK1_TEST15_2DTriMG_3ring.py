import numpy as np

v1 = 17275242.3696709
v2 = 401564.43937632954
beff = 0.00691925
lambda_bar = 0.09463531992877287
keff_serpent = 1.51474
FLX = [[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.988197261811507, 0.9906700494557529, 0.9875016076042604, 0.0, 0.0, 0.0, 0.9907694286282167, 0.9990354374437339, 0.998883445768201, 0.991050028644585, 0.0, 0.0, 0.9876185242777472, 0.9983397832364874, 1.0, 0.9993394207947995, 0.9877646701196057, 0.0, 0.0, 0.9908337327986343, 0.9993101916264279, 0.9987022249242964, 0.9902725327658978, 0.0, 0.0, 0.0, 0.9880394243022999, 0.9899627035811577, 0.9864025908734845, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.24642176520793632, 0.22524815563947573, 0.24632530895230967, 0.0, 0.0, 0.0, 0.22527680022448002, 0.17508797979679883, 0.1750067227087255, 0.22528615355835896, 0.0, 0.0, 0.24617565561024657, 0.17510200979761723, 0.1663484584536601, 0.17491903520361038, 0.24616104102606073, 0.0, 0.0, 0.2252288643883504, 0.174971063123312, 0.17499853854158143, 0.22509148729700343, 0.0, 0.0, 0.0, 0.2461826706106558, 0.22484830061615088, 0.24611719727350317, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]]
NUFIS = [[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0105251, 0.0103943, 0.0105354, 0.0, 0.0, 0.0, 0.010406, 0.0100802, 0.0100614, 0.0103934, 0.0, 0.0, 0.01054, 0.0100587, 0.0100155, 0.0100705, 0.0105449, 0.0, 0.0, 0.0103982, 0.0100755, 0.0100747, 0.010402, 0.0, 0.0, 0.0, 0.010541, 0.0103919, 0.0105435, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.17164, 0.170922, 0.171741, 0.0, 0.0, 0.0, 0.17098, 0.168207, 0.168416, 0.170838, 0.0, 0.0, 0.171618, 0.168526, 0.167853, 0.168382, 0.171631, 0.0, 0.0, 0.170826, 0.168442, 0.168224, 0.170884, 0.0, 0.0, 0.0, 0.171917, 0.170816, 0.171578, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]]
chi = [[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.0, 1.0, 1.0, 0.0, 0.0, 0.0, 1.0, 1.0, 1.0, 1.0, 0.0, 0.0, 1.0, 1.0, 1.0, 1.0, 1.0, 0.0, 0.0, 1.0, 1.0, 1.0, 1.0, 0.0, 0.0, 0.0, 1.0, 1.0, 1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]]
TOT = [[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.471487, 0.471835, 0.471507, 0.0, 0.0, 0.0, 0.471701, 0.473156, 0.473072, 0.471812, 0.0, 0.0, 0.471312, 0.473041, 0.475067, 0.472811, 0.47146, 0.0, 0.0, 0.471801, 0.472971, 0.473021, 0.471863, 0.0, 0.0, 0.0, 0.471392, 0.471689, 0.471369, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.4051, 1.39907, 1.40579, 0.0, 0.0, 0.0, 1.39842, 1.37799, 1.37853, 1.39905, 0.0, 0.0, 1.40566, 1.37805, 1.37427, 1.37825, 1.40569, 0.0, 0.0, 1.39886, 1.379, 1.37823, 1.39917, 0.0, 0.0, 0.0, 1.40441, 1.39979, 1.40547, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]]
ABS = [[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.00976467, 0.00967022, 0.00978001, 0.0, 0.0, 0.0, 0.00967511, 0.00945744, 0.00944317, 0.00966895, 0.0, 0.0, 0.00977577, 0.00944678, 0.00945829, 0.00945156, 0.00978605, 0.0, 0.0, 0.00968025, 0.0094558, 0.00945465, 0.0096804, 0.0, 0.0, 0.0, 0.00978098, 0.00968097, 0.00978071, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0966829, 0.0962731, 0.0967388, 0.0, 0.0, 0.0, 0.0963011, 0.0947456, 0.094855, 0.0962323, 0.0, 0.0, 0.0966746, 0.0949106, 0.0945383, 0.0948347, 0.0966802, 0.0, 0.0, 0.0962255, 0.0948706, 0.0947501, 0.0962566, 0.0, 0.0, 0.0, 0.0968229, 0.0962251, 0.0966531, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]]
D1 = [[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 1.84868, 1.84582, 1.84827, 0.0], [0.0, 0.0, 1.8465, 1.83695, 1.83785, 1.84612, 0.0], [0.0, 1.8482, 1.83845, 1.82776, 1.83843, 1.8485, 0.0], [0.0, 1.84663, 1.83753, 1.83737, 1.8463, 0.0, 0.0], [0.0, 1.84956, 1.84609, 1.84849, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]]
SIGS11 = [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.444989, 0.445702, 0.444977, 0.0, 0.0, 0.0, 0.445589, 0.447936, 0.447897, 0.445677, 0.0, 0.0, 0.444812, 0.447863, 0.449949, 0.447659, 0.444947, 0.0, 0.0, 0.445663, 0.447782, 0.44786, 0.445705, 0.0, 0.0, 0.0, 0.444883, 0.44556, 0.444834, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
SIGS12 = [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0166694, 0.0164113, 0.0166917, 0.0, 0.0, 0.0, 0.0163783, 0.0157066, 0.0156883, 0.0163918, 0.0, 0.0, 0.0166749, 0.0156652, 0.0156036, 0.0156546, 0.0166737, 0.0, 0.0, 0.0164, 0.0156819, 0.015654, 0.016408, 0.0, 0.0, 0.0, 0.0166631, 0.0163782, 0.0166893, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
D2 = [[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.372069, 0.374276, 0.371623, 0.0], [0.0, 0.0, 0.374544, 0.382719, 0.382671, 0.374454, 0.0], [0.0, 0.371788, 0.382616, 0.384285, 0.382481, 0.37175, 0.0], [0.0, 0.374366, 0.38241, 0.3824, 0.374333, 0.0, 0.0], [0.0, 0.372, 0.374229, 0.371868, 0.0, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]]
SIGS21 = [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.00108298, 0.00116532, 0.0010892, 0.0, 0.0, 0.0, 0.00117559, 0.00142581, 0.00141962, 0.00118384, 0.0, 0.0, 0.0010922, 0.00140267, 0.00149731, 0.00140631, 0.00108917, 0.0, 0.0, 0.00117135, 0.0014005, 0.0014263, 0.00116708, 0.0, 0.0, 0.0, 0.00108117, 0.00116298, 0.00110003, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]
SIGS22 = [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 1.30734, 1.30164, 1.30797, 0.0, 0.0, 0.0, 1.30099, 1.28178, 1.28221, 1.30168, 0.0, 0.0, 1.3079, 1.28179, 1.27832, 1.28197, 1.30791, 0.0, 0.0, 1.30146, 1.2827, 1.28203, 1.30169, 0.0, 0.0, 0.0, 1.30651, 1.30236, 1.30779, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]

# RESHAPING
D = [D1, D2]
SIGS_reshaped = [[SIGS11, SIGS21], [SIGS12, SIGS22]]

# DIMENSIONS
level = 1
geom_type = '2D triangular'
precond = 0
s = 10.0 # Side-to-side of Hexagon
h_hexx = s / np.sqrt(3) # Triangle side or hexagon radius
h = h_hexx / (2**(level-1))
I_max = len(D[0][0])
J_max = len(D[0])
group = len(D)
num_tri = 6 * (4 ** (level - 1))
N = I_max * J_max
N_hexx = I_max * J_max * num_tri

# INITIALIZATION
input_name = f"TASK1_TEST15_2DTriMG_3ring" 
case_name = f"{input_name}_level{level}"

# BC
BC = [2, 2, 2, 2]  # N, S, E, W
